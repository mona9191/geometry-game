<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>Ø¨Ø§Ø²ÛŒ Ø³Ø·Ø­ Ùˆ Ø­Ø¬Ù… Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ</title>
  <style>
    body {
      font-family: 'Tahoma';
      text-align: center;
      margin: 0;
      background: linear-gradient(135deg, #74ebd5 0%, #ACB6E5 100%);
      color: #333;
    }
    #quiz { margin: 20px; }
    .question { font-size: 22px; margin: 20px; font-weight: bold; }
    .option {
      display: inline-block;
      width: 200px;
      background: #eee;
      margin: 10px;
      padding: 15px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 18px;
    }
    .option:hover { transform: scale(1.05); background: #ddd; }
    .correct { background: #4CAF50; color: white; }
    .wrong { background: #F44336; color: white; }
    canvas { display: block; margin: auto; }
    #score, #timer { font-size: 20px; margin: 10px; font-weight: bold; }
    #difficulty { margin: 20px; }
    button {
      padding: 12px 25px; margin: 5px; border: none; border-radius: 8px;
      font-size: 16px; cursor: pointer; transition: 0.3s;
    }
    button:hover { transform: scale(1.05); background: #333; color: #fff; }
  </style>
</head>
<body>
  <h1>ðŸŽ® Ø¨Ø§Ø²ÛŒ Ø³Ø·Ø­ Ùˆ Ø­Ø¬Ù… Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ</h1>

  <div id="difficulty">
    <p>Ø³Ø·Ø­ Ø³Ø®ØªÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯:</p>
    <button id="btn-easy">Ø¢Ø³Ø§Ù†</button>
    <button id="btn-medium">Ù…ØªÙˆØ³Ø·</button>
    <button id="btn-hard">Ø³Ø®Øª</button>
  </div>

  <div id="score"></div>
  <div id="timer"></div>
  <div id="quiz"></div>

  <!-- Three.js Ùˆ OrbitControls Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‡Ù…Ø§Ù‡Ù†Ú¯ -->
  <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

  <script>
    // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø§Ø­Ù„
    const stages = [
      { q: "Ø­Ø¬Ù… Ù…Ú©Ø¹Ø¨ÛŒ Ø¨Ø§ Ø¶Ù„Ø¹ Û´ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ", opts: ["Û¶Û´","Û±Û²","Û´Û¸","Û¸Û°"], correct: 0, geo: () => new THREE.BoxGeometry(2,2,2) },
      { q: "Ù…Ø³Ø§Ø­Øª Ø³Ø·Ø­ÛŒ Ù…Ú©Ø¹Ø¨ÛŒ Ø¨Ø§ Ø¶Ù„Ø¹ Û´ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ", opts: ["Û¹Û¶","Û¶Û´","Û´Û¸","Û±Û²Û°"], correct: 0, geo: () => new THREE.BoxGeometry(2,2,2) },
      { q: "Ø­Ø¬Ù… Ú©Ø±Ù‡â€ŒØ§ÛŒ Ø¨Ø§ Ø´Ø¹Ø§Ø¹ Û³ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ (ØªÙ‚Ø±ÛŒØ¨Ø§Ù‹)", opts: ["Û±Û±Û³","Û¹Û°","Û·Ûµ","Û±ÛµÛ°"], correct: 0, geo: () => new THREE.SphereGeometry(1.5,32,32) },
      { q: "Ù…Ø³Ø§Ø­Øª Ø³Ø·Ø­ÛŒ Ú©Ø±Ù‡â€ŒØ§ÛŒ Ø¨Ø§ Ø´Ø¹Ø§Ø¹ Û³ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ (ØªÙ‚Ø±ÛŒØ¨Ø§Ù‹)", opts: ["Û±Û±Û³","Û±Û±Û³.1","Û±Û±Û³.2","Û±Û±Û³.3"], correct: 0, geo: () => new THREE.SphereGeometry(1.5,32,32) },
      { q: "Ø­Ø¬Ù… Ù…Ø®Ø±ÙˆØ·ÛŒ Ø¨Ø§ Ø´Ø¹Ø§Ø¹ Ù‚Ø§Ø¹Ø¯Ù‡ Û³ Ùˆ Ø§Ø±ØªÙØ§Ø¹ Û´ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ", opts: ["Û³Û·","Û±Û±Û³","Û±ÛµÛ°","Û·Ûµ"], correct: 1, geo: () => new THREE.ConeGeometry(1.5,2,32) },
      { q: "Ù…Ø³Ø§Ø­Øª Ø³Ø·Ø­ÛŒ Ù…Ø®Ø±ÙˆØ·ÛŒ Ø¨Ø§ Ø´Ø¹Ø§Ø¹ Û³ Ùˆ Ø§Ø±ØªÙØ§Ø¹ Û´ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ (ØªÙ‚Ø±ÛŒØ¨Ø§Ù‹)", opts: ["Û·Ûµ","Û¹Û°","Û±Û±Û³","Û±Û²Û°"], correct: 2, geo: () => new THREE.ConeGeometry(1.5,2,32) },
      { q: "Ø­Ø¬Ù… Ø§Ø³ØªÙˆØ§Ù†Ù‡â€ŒØ§ÛŒ Ø¨Ø§ Ø´Ø¹Ø§Ø¹ Û² Ùˆ Ø§Ø±ØªÙØ§Ø¹ Ûµ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ", opts: ["Û¶Û³","Û´Û°","ÛµÛ°","Û·Û°"], correct: 0, geo: () => new THREE.CylinderGeometry(1,1,2.5,32) },
      { q: "Ù…Ø³Ø§Ø­Øª Ø³Ø·Ø­ÛŒ Ø§Ø³ØªÙˆØ§Ù†Ù‡â€ŒØ§ÛŒ Ø¨Ø§ Ø´Ø¹Ø§Ø¹ Û² Ùˆ Ø§Ø±ØªÙØ§Ø¹ Ûµ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ", opts: ["Û¸Û¸","Û¹Û°","Û±Û°Û°","Û±Û²Û°"], correct: 0, geo: () => new THREE.CylinderGeometry(1,1,2.5,32) }
    ];

    // ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
    let difficulty = null;
    let currentStage = 0;
    let score = 0;
    let timeLeft = 0;
    let timerInterval = null;

    // Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / (window.innerHeight/2), 0.1, 1000);
    camera.position.z = 5;

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight / 2);
    document.body.appendChild(renderer.domElement);

    const light1 = new THREE.PointLight(0x00ffff, 1, 100);
    light1.position.set(10, 10, 10);
    scene.add(light1);

    const light2 = new THREE.PointLight(0xff00ff, 1, 100);
    light2.position.set(-10, -10, -10);
    scene.add(light2);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);

    let shape = null;

    // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
    const btnEasy = document.getElementById('btn-easy');
    const btnMedium = document.getElementById('btn-medium');
    const btnHard = document.getElementById('btn-hard');
btnEasy.addEventListener('click', () => startGame('easy'));
    btnMedium.addEventListener('click', () => startGame('medium'));
    btnHard.addEventListener('click', () => startGame('hard'));

    function startGame(level) {
      try {
        console.log('Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ø¨Ø§ Ø³Ø·Ø­:', level);
        difficulty = level;
        score = 0;
        currentStage = 0;
        document.getElementById('difficulty').style.display = 'none';
        document.getElementById('score').innerText = 'Ø§Ù…ØªÛŒØ§Ø²: ' + score;
        loadStage(currentStage);
      } catch (e) {
        console.error('Ø®Ø·Ø§ Ø¯Ø± startGame:', e);
        alert('Ù…Ø´Ú©Ù„ Ø¯Ø± Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ. Ú©Ù†Ø³ÙˆÙ„ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†.');
      }
    }

    function loadStage(index) {
      try {
        console.log('Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø±Ø­Ù„Ù‡:', index);
        // Ø­Ø°Ù Ø´Ú©Ù„ Ù‚Ø¨Ù„ÛŒ
        if (shape) {
          scene.remove(shape);
          shape.geometry.dispose();
          shape.material.dispose();
          shape = null;
        }

        // Ø³Ø§Ø®Øª Ø´Ú©Ù„ Ø¬Ø¯ÛŒØ¯
        const material = new THREE.MeshPhongMaterial({ color: 0x00ff00, shininess: 100 });
        shape = new THREE.Mesh(stages[index].geo(), material);
        scene.add(shape);

        // Ù†Ù…Ø§ÛŒØ´ Ø³Ø¤Ø§Ù„ Ùˆ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
        const quizDiv = document.getElementById('quiz');
        quizDiv.innerHTML = '';
        const qEl = document.createElement('div');
        qEl.className = 'question';
        qEl.textContent = stages[index].q;
        quizDiv.appendChild(qEl);

        stages[index].opts.forEach((opt, i) => {
          const optEl = document.createElement('div');
          optEl.className = 'option';
          optEl.textContent = opt;
          optEl.addEventListener('click', () => checkAnswer(optEl, i === stages[index].correct));
          quizDiv.appendChild(optEl);
        });

        // ØªÙ†Ø¸ÛŒÙ… ØªØ§ÛŒÙ…Ø±
        timeLeft = (difficulty === 'easy') ? 30 : (difficulty === 'medium') ? 20 : 10;
        document.getElementById('timer').innerText = 'Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: ' + timeLeft + ' Ø«Ø§Ù†ÛŒÙ‡';
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(updateTimer, 1000);
      } catch (e) {
        console.error('Ø®Ø·Ø§ Ø¯Ø± loadStage:', e);
        alert('Ù…Ø´Ú©Ù„ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø±Ø­Ù„Ù‡. Ú©Ù†Ø³ÙˆÙ„ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†.');
      }
    }

    function updateTimer() {
      timeLeft--;
      document.getElementById('timer').innerText = 'Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: ' + timeLeft + ' Ø«Ø§Ù†ÛŒÙ‡';
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        alert('â± Ø²Ù…Ø§Ù† ØªÙ…Ø§Ù… Ø´Ø¯!');
        nextStage();
      }
    }

    function checkAnswer(el, isCorrect) {
      clearInterval(timerInterval);
      if (isCorrect) {
        el.classList.add('correct');
        score++;
        document.getElementById('score').innerText = 'Ø§Ù…ØªÛŒØ§Ø²: ' + score;
        alert('Ø¢ÙØ±ÛŒÙ†! Ø¬ÙˆØ§Ø¨ Ø¯Ø±Ø³Øª Ø¨ÙˆØ¯ ðŸŽ‰');
      } else {
        el.classList.add('wrong');
        alert('Ø§Ø´ØªØ¨Ø§Ù‡ Ø´Ø¯ ðŸ˜…');
      }
      nextStage();
    }

    function nextStage() {
      currentStage++;
      if (currentStage < stages.length) {
        loadStage(currentStage);
      } else {
        alert('ðŸ‘ ØªØ¨Ø±ÛŒÚ©! Ù‡Ù…Ù‡ Ù…Ø±Ø§Ø­Ù„ Ø³Ø·Ø­ Ùˆ Ø­Ø¬Ù… Ø±Ùˆ Ú¯Ø°Ø±ÙˆÙ†Ø¯ÛŒ. Ø§Ù…ØªÛŒØ§Ø² Ù†Ù‡Ø§ÛŒÛŒ: ' + score);
        // Ø§Ù…Ú©Ø§Ù† Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¨Ø§Ø±Ù‡
        document.getElementById('difficulty').style.display = 'block';
        document.getElementById('quiz').innerHTML = '';
        document.getElementById('timer').innerText = '';
      }
    }

    // Ø±Ù†Ø¯Ø± Ø¯Ø§Ø¦Ù…ÛŒ
    function animate() {
      requestAnimationFrame(animate);
      renderer.render(scene, camera);
    }
    animate();

    // ÙˆØ§Ú©Ù†Ø´ Ø¨Ù‡ ØªØºÛŒÛŒØ± Ø§Ù†Ø¯Ø§Ø²Ù‡ ØµÙØ­Ù‡
    window.addEventListener('resize', () => {
      renderer.setSize(window.innerWidth, window.innerHeight / 2);
      camera.aspect = window.innerWidth / (window.innerHeight / 2);
      camera.updateProjectionMatrix();
    });
  </script>
</body>
</html>